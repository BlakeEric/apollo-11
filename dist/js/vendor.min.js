/*! apollo-11 v0.0.1 | (c) 2020 Blake Lundquist | MIT License | https://github.com/BlakeEric/apollo-11 */
!(function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.download=t()})(this,(function(){return function t(e,n,o){function r(e){return String(e)}var i,a,s=window,c="application/octet-stream",d=o||c,f=e,u=!n&&!o&&f,l=document.createElement("a"),h=s.Blob||s.MozBlob||s.WebKitBlob||r,g=n||"download";if(h=h.call?h.bind(s):Blob,"true"===String(this)&&(d=(f=[f,d])[0],f=f[1]),u&&u.length<2048&&(g=u.split("/").pop().split("?")[0],l.href=u,-1!==l.href.indexOf(u))){var p=new XMLHttpRequest;return p.open("GET",u,!0),p.responseType="blob",p.onload=function(e){t(e.target.response,g,c)},setTimeout((function(){p.send()}),0),p}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(f)){if(!(2096103.424<f.length&&h!==r))return navigator.msSaveBlob?navigator.msSaveBlob(C(f),g):E(f);d=(f=C(f)).type||c}else if(/([\x80-\xff])/.test(f)){for(var m=0,v=new Uint8Array(f.length),R=v.length;m<R;++m)v[m]=f.charCodeAt(m);f=new h([v],{type:d})}function C(e){for(var t=e.split(/[:;,]/),n=t[1],o=("base64"==t[0<e.indexOf("charset")?3:2]?atob:decodeURIComponent)(t.pop()),r=o.length,i=0,a=new Uint8Array(r);i<r;++i)a[i]=o.charCodeAt(i);return new h([a],{type:n})}function E(e,t){if("download"in l)return l.href=e,l.setAttribute("download",g),l.className="download-js-link",l.innerHTML="downloading...",l.style.display="none",l.addEventListener("click",(function(e){e.stopPropagation(),this.removeEventListener("click",arguments.callee)})),document.body.appendChild(l),setTimeout((function(){l.click(),document.body.removeChild(l),!0===t&&setTimeout((function(){s.URL.revokeObjectURL(l.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,c)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var n=document.createElement("iframe");document.body.appendChild(n),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,c)),n.src=e,setTimeout((function(){document.body.removeChild(n)}),333)}if(i=f instanceof h?f:new h([f],{type:d}),navigator.msSaveBlob)return navigator.msSaveBlob(i,g);if(s.URL)E(s.URL.createObjectURL(i),!0);else{if("string"==typeof i||i.constructor===r)try{return E("data:"+d+";base64,"+s.btoa(i))}catch(e){return E("data:"+d+","+encodeURIComponent(i))}(a=new FileReader).onload=function(e){E(this.result)},a.readAsDataURL(i)}return!0}})),window.Element&&!Element.prototype.closest&&(Element.prototype.closest=function(e){var t,n=(this.document||this.ownerDocument).querySelectorAll(e),o=this;do{for(t=n.length;0<=--t&&n.item(t)!==o;);}while(t<0&&(o=o.parentElement));return o}),(function(e,t){"function"==typeof define&&define.amd?define([],(function(){return t(e)})):"object"==typeof exports?module.exports=t(e):e.events=t(e)})("undefined"!=typeof global?global:"undefined"!=typeof window?window:this,(function(r){"use strict";function i(o){s[o.type]&&s[o.type].forEach((function(e){var t,n;t=o.target,n=e.selector,(-1<["*","window","document","document.documentElement",r,document,document.documentElement].indexOf(n)||("string"!=typeof n&&n.contains?n===t||n.contains(t):t.closest(n)))&&e.callback(o)}))}var a={},s={};return a.on=function(e,t,n){t&&n&&e.split(",").forEach((function(e){e=e.trim(),s[e]||(s[e]=[],r.addEventListener(e,i,!0)),s[e].push({selector:t,callback:n})}))},a.off=function(e,n,o){e.split(",").forEach((function(e){if(e=e.trim(),s[e]){if(s[e].length<2||!n)return delete s[e],void r.removeEventListener(e,i,!0);var t=(function(e,t,n){for(var o=0;o<e.length;o++)if(e[o].selector===t&&e[o].callback.toString()===n.toString())return o;return-1})(s[e],n,o);t<0||s[e].splice(t,1)}}))},a.once=function(n,o,r){a.on(n,o,(function e(t){r(t),a.off(n,o,e)}))},a.get=function(){var e={};for(var t in s)s.hasOwnProperty(t)&&(e[t]=s[t]);return e},a})),Element.prototype.closest||(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest=function(e){var t=this;if(!document.documentElement.contains(this))return null;do{if(t.matches(e))return t;t=t.parentElement}while(null!==t);return null}),(function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}"function"!=typeof window.CustomEvent&&(e.prototype=window.Event.prototype,window.CustomEvent=e)})(),(function(e,t){"function"==typeof define&&define.amd?define([],(function(){return t(e)})):"object"==typeof exports?module.exports=t(e):e.Gumshoe=t(e)})("undefined"!=typeof global?global:"undefined"!=typeof window?window:this,(function(f){"use strict";function u(e,t,n){if(n.settings.events){var o=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t.dispatchEvent(o)}}function n(e){var t=0;if(e.offsetParent)for(;e;)t+=e.offsetTop,e=e.offsetParent;return 0<=t?t:0}function l(e){e&&e.sort((function(e,t){return n(e.content)<n(t.content)?-1:1}))}function a(e,t,n){var o,r=e.getBoundingClientRect(),i="function"==typeof(o=t).offset?parseFloat(o.offset()):parseFloat(o.offset);return n?parseInt(r.bottom,10)<(f.innerHeight||document.documentElement.clientHeight):parseInt(r.top,10)<=i}function h(e,t){var n,o,r=e[e.length-1];if(n=r,o=t,f.innerHeight+f.pageYOffset>=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)&&a(n.content,o,!0))return r;for(var i=e.length-1;0<=i;i--)if(a(e[i].content,t))return e[i]}function g(e,t){if(e){var n=e.nav.closest("li");n&&(n.classList.remove(t.navClass),e.content.classList.remove(t.contentClass),o(n,t),u("gumshoeDeactivate",n,{link:e.nav,content:e.content,settings:t}))}}var p={navClass:"active",contentClass:"active",nested:!1,nestedClass:"active",offset:0,reflow:!1,events:!0},o=function(e,t){if(t.nested&&e.parentNode){var n=e.parentNode.closest("li");n&&(n.classList.remove(t.nestedClass),o(n,t))}},m=function(e,t){if(t.nested){var n=e.parentNode.closest("li");n&&(n.classList.add(t.nestedClass),m(n,t))}};return function(e,t){function n(e){s&&f.cancelAnimationFrame(s),s=f.requestAnimationFrame(d.detect)}function o(e){s&&f.cancelAnimationFrame(s),s=f.requestAnimationFrame((function(){l(i),d.detect()}))}var r,i,a,s,c,d={setup:function(){r=document.querySelectorAll(e),i=[],Array.prototype.forEach.call(r,(function(e){var t=document.getElementById(decodeURIComponent(e.hash.substr(1)));t&&i.push({nav:e,content:t})})),l(i)},detect:function(){var e=h(i,c);e?a&&e.content===a.content||(g(a,c),(function(e,t){if(e){var n=e.nav.closest("li");n&&(n.classList.add(t.navClass),e.content.classList.add(t.contentClass),m(n,t),u("gumshoeActivate",n,{link:e.nav,content:e.content,settings:t}))}})(e,c),a=e):a&&(g(a,c),a=null)}};return d.destroy=function(){a&&g(a,c),f.removeEventListener("scroll",n,!1),c.reflow&&f.removeEventListener("resize",o,!1),c=s=a=r=i=null},c=(function(){var n={};return Array.prototype.forEach.call(arguments,(function(e){for(var t in e){if(!e.hasOwnProperty(t))return;n[t]=e[t]}})),n})(p,t||{}),d.setup(),d.detect(),f.addEventListener("scroll",n,!1),c.reflow&&f.addEventListener("resize",o,!1),d}})),(function(e,t){"function"==typeof define&&define.amd?define(e):"undefined"!=typeof module&&"object"==typeof exports?module.exports=e():t.rangy=e()})((function(){var o="object",r="function",n="undefined",c=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],d=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],t=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],i=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"];function f(e,t){var n=typeof e[t];return n==r||!(n!=o||!e[t])||"unknown"==n}function a(e,t){return!(typeof e[t]!=o||!e[t])}function e(e,t){return typeof e[t]!=n}function s(o){return function(e,t){for(var n=t.length;n--;)if(!o(e,t[n]))return!1;return!0}}var u=s(f),l=s(a),h=s(e);function g(e){return e&&u(e,i)&&h(e,t)}function p(e){return a(e,"body")?e.body:e.getElementsByTagName("body")[0]}var m,v,R={},C=typeof window!=n&&typeof document!=n,E={isHostMethod:f,isHostObject:a,isHostProperty:e,areHostMethods:u,areHostObjects:l,areHostProperties:h,isTextRange:g,getBody:p,forEach:[].forEach?function(e,t){e.forEach(t)}:function(e,t){for(var n=0,o=e.length;n<o;++n)t(e[n],n)}},N={version:"1.3.1-dev",initialized:!1,isBrowser:C,supported:!0,util:E,features:{},modules:R,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==n||rangyAutoInitialize}};function y(e){typeof console!=n&&f(console,"log")&&console.log(e)}function w(e,t){(C&&t?alert:y)(e)}function S(e){N.initialized=!0,N.supported=!1,w("Rangy is not supported in this environment. Reason: "+e,N.config.alertOnFail)}N.fail=S,N.warn=function(e){w("Rangy warning: "+e,N.config.alertOnWarn)},!{}.hasOwnProperty?S("hasOwnProperty not supported"):(E.extend=m=function(e,t,n){var o,r;for(var i in t)t.hasOwnProperty(i)&&(o=e[i],r=t[i],n&&null!==o&&"object"==typeof o&&null!==r&&"object"==typeof r&&m(o,r,!0),e[i]=r);return t.hasOwnProperty("toString")&&(e.toString=t.toString),e},E.createOptions=function(e,t){var n={};return m(n,t),e&&m(n,e),n}),C||S("Rangy can only run in a browser"),(function(){var e;if(C){var t=document.createElement("div");t.appendChild(document.createElement("span"));var n=[].slice;try{1==n.call(t.childNodes,0)[0].nodeType&&(e=function(e){return n.call(e,0)})}catch(e){}}e=e||function(e){for(var t=[],n=0,o=e.length;n<o;++n)t[n]=e[n];return t},E.toArray=e})(),C&&(f(document,"addEventListener")?v=function(e,t,n){e.addEventListener(t,n,!1)}:f(document,"attachEvent")?v=function(e,t,n){e.attachEvent("on"+t,n)}:S("Document does not have required addEventListener or attachEvent method"),E.addListener=v);var T=[];function O(e){return e.message||e.description||String(e)}function _(){if(C&&!N.initialized){var e,t=!1,n=!1;f(document,"createRange")&&(e=document.createRange(),u(e,d)&&h(e,c)&&(t=!0));var o=p(document);if(o&&"body"==o.nodeName.toLowerCase())if(o&&f(o,"createTextRange")&&g(e=o.createTextRange())&&(n=!0),t||n){var r;for(var i in N.initialized=!0,N.features={implementsDomRange:t,implementsTextRange:n},R)(r=R[i])instanceof x&&r.init(r,N);for(var a=0,s=T.length;a<s;++a)try{T[a](N)}catch(e){y("Rangy init listener threw an exception. Continuing. Detail: "+O(e))}}else S("Neither Range nor TextRange are available");else S("No body element found")}}function A(e,t,n){n&&(e+=" in module "+n.name),N.warn("DEPRECATED: "+e+" is deprecated. Please use "+t+" instead.")}function D(e,t,n,o){e[t]=function(){return A(t,n,o),e[n].apply(e,E.toArray(arguments))}}E.deprecationNotice=A,E.createAliasForDeprecatedMethod=D,N.init=_,N.addInitListener=function(e){N.initialized?e(N):T.push(e)};var b=[];function x(e,t,n){this.name=e,this.dependencies=t,this.initialized=!1,this.supported=!1,this.initializer=n}function P(t,e,n){var o=new x(t,e,function(e){if(!e.initialized){e.initialized=!0;try{n(N,e),e.supported=!0}catch(e){y("Module '"+t+"' failed to load: "+O(e)),e.stack&&y(e.stack)}}});return R[t]=o}function I(){}N.addShimListener=function(e){b.push(e)},C&&(N.shim=N.createMissingNativeApi=function(e){e=e||window,_();for(var t=0,n=b.length;t<n;++t)b[t](e)},D(N,"createMissingNativeApi","shim")),x.prototype={init:function(){for(var e,t,n=this.dependencies||[],o=0,r=n.length;o<r;++o){if(!((e=R[t=n[o]])&&e instanceof x))throw new Error("required module '"+t+"' not found");if(e.init(),!e.supported)throw new Error("required module '"+t+"' not supported")}this.initializer(this)},fail:function(e){throw this.initialized=!0,this.supported=!1,new Error(e)},warn:function(e){N.warn("Module "+this.name+": "+e)},deprecationNotice:function(e,t){N.warn("DEPRECATED: "+e+" in module "+this.name+" is deprecated. Please use "+t+" instead")},createError:function(e){return new Error("Error in Rangy "+this.name+" module: "+e)}},N.createModule=function(e){var t,n=P(e,2==arguments.length?(t=arguments[1],[]):(t=arguments[2],arguments[1]),t);N.initialized&&N.supported&&n.init()},N.createCoreModule=function(e,t,n){P(e,t,n)},N.RangePrototype=I,N.rangePrototype=new I,N.selectionPrototype=new function(){},N.createCoreModule("DomUtil",[],(function(n,d){var o="undefined",r=n.util,a=r.getBody;r.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||d.fail("document missing a Node creation method"),r.isHostMethod(document,"getElementsByTagName")||d.fail("document missing getElementsByTagName method");var e=document.createElement("div");r.areHostMethods(e,["insertBefore","appendChild","cloneNode"])||d.fail("Incomplete Element implementation"),r.isHostProperty(e,"innerHTML")||d.fail("Element is missing innerHTML property");var t=document.createTextNode("test");r.areHostMethods(t,["splitText","deleteData","insertData","appendData","cloneNode"])||d.fail("Incomplete Text Node implementation");var i=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1};function f(e){for(var t=0;e=e.previousSibling;)++t;return t}function u(e,t){var n,o=[];for(n=e;n;n=n.parentNode)o.push(n);for(n=t;n;n=n.parentNode)if(i(o,n))return n;return null}function s(e,t,n){for(var o=n?t:t.parentNode;o;){if(o===e)return!0;o=o.parentNode}return!1}function l(e,t,n){for(var o,r=n?e:e.parentNode;r;){if((o=r.parentNode)===t)return r;r=o}return null}function c(e){var t=e.nodeType;return 3==t||4==t||8==t}function h(e,t){var n=t.nextSibling,o=t.parentNode;return n?o.insertBefore(e,n):o.appendChild(e),e}function g(e){if(9==e.nodeType)return e;if(typeof e.ownerDocument!=o)return e.ownerDocument;if(typeof e.document!=o)return e.document;if(e.parentNode)return g(e.parentNode);throw d.createError("getDocument: no document found for node")}function p(e){var t=g(e);if(typeof t.defaultView!=o)return t.defaultView;if(typeof t.parentWindow!=o)return t.parentWindow;throw d.createError("Cannot get a window object for node")}function m(e){if(typeof e.contentDocument!=o)return e.contentDocument;if(typeof e.contentWindow!=o)return e.contentWindow.document;throw d.createError("getIframeDocument: No Document object found for iframe element")}function v(e){return e&&r.isHostMethod(e,"setTimeout")&&r.isHostObject(e,"document")}var R,C=!1;function E(e){try{return e.parentNode,!1}catch(e){return!0}}function N(e){if(!e)return"[No node]";if(C&&E(e))return"[Broken node]";if(c(e))return'"'+e.data+'"';if(1!=e.nodeType)return e.nodeName;var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">[index:"+f(e)+",length:"+e.childNodes.length+"]["+(e.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}function y(e){this.root=e,this._next=e}function w(e,t){this.node=e,this.offset=t}function S(e){this.code=this[e],this.codeName=e,this.message="DOMException: "+this.codeName}!(function(){var e=document.createElement("b");e.innerHTML="1";var t=e.firstChild;e.innerHTML="<br />",C=E(t),n.features.crashyTextNodes=C})(),typeof window.getComputedStyle!=o?R=function(e,t){return p(e).getComputedStyle(e,null)[t]}:typeof document.documentElement.currentStyle!=o?R=function(e,t){return e.currentStyle?e.currentStyle[t]:""}:d.fail("No means of obtaining computed style properties found"),y.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e,t,n=this._current=this._next;if(this._current)if(e=n.firstChild)this._next=e;else{for(t=null;n!==this.root&&!(t=n.nextSibling);)n=n.parentNode;this._next=t}return this._current},detach:function(){this._current=this._next=this.root=null}},w.prototype={equals:function(e){return!!e&&this.node===e.node&&this.offset==e.offset},inspect:function(){return"[DomPosition("+N(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},(S.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24}).toString=function(){return this.message},n.dom={arrayContains:i,isHtmlNamespace:function(e){var t;return typeof e.namespaceURI==o||null===(t=e.namespaceURI)||"http://www.w3.org/1999/xhtml"==t},parentElement:function(e){var t=e.parentNode;return 1==t.nodeType?t:null},getNodeIndex:f,getNodeLength:function(e){switch(e.nodeType){case 7:case 10:return 0;case 3:case 8:return e.length;default:return e.childNodes.length}},getCommonAncestor:u,isAncestorOf:s,isOrIsAncestorOf:function(e,t){return s(e,t,!0)},getClosestAncestorIn:l,isCharacterDataNode:c,isTextOrCommentNode:function(e){if(!e)return!1;var t=e.nodeType;return 3==t||8==t},insertAfter:h,splitDataNode:function(e,t,n){var o=e.cloneNode(!1);if(o.deleteData(0,t),e.deleteData(t,e.length-t),h(o,e),n)for(var r,i=0;r=n[i++];)r.node==e&&r.offset>t?(r.node=o,r.offset-=t):r.node==e.parentNode&&r.offset>f(e)&&++r.offset;return o},getDocument:g,getWindow:p,getIframeWindow:function(e){if(typeof e.contentWindow!=o)return e.contentWindow;if(typeof e.contentDocument!=o)return e.contentDocument.defaultView;throw d.createError("getIframeWindow: No Window object found for iframe element")},getIframeDocument:m,getBody:a,isWindow:v,getContentDocument:function(e,t,n){var o;if(e?r.isHostProperty(e,"nodeType")?o=(1==e.nodeType&&"iframe"==e.tagName.toLowerCase()?m:g)(e):v(e)&&(o=e.document):o=document,!o)throw t.createError(n+"(): Parameter must be a Window object or DOM node");return o},getRootContainer:function(e){for(var t;t=e.parentNode;)e=t;return e},comparePoints:function(e,t,n,o){var r,i,a,s,c;if(e==n)return t===o?0:t<o?-1:1;if(r=l(n,e,!0))return t<=f(r)?-1:1;if(r=l(e,n,!0))return f(r)<o?-1:1;if(!(i=u(e,n)))throw new Error("comparePoints error: nodes have no common ancestor");if((a=e===i?i:l(e,i,!0))===(s=n===i?i:l(n,i,!0)))throw d.createError("comparePoints got to case 4 and childA and childB are the same!");for(c=i.firstChild;c;){if(c===a)return-1;if(c===s)return 1;c=c.nextSibling}},isBrokenNode:E,inspectNode:N,getComputedStyleProperty:R,createTestElement:function(e,t,n){var o=a(e),r=e.createElement("div");r.contentEditable=""+!!n,t&&(r.innerHTML=t);var i=o.firstChild;return i?o.insertBefore(r,i):o.appendChild(r),r},removeNode:function(e){return e.parentNode.removeChild(e)},fragmentFromNodeChildren:function(e){for(var t,n=g(e).createDocumentFragment();t=e.firstChild;)n.appendChild(t);return n},createIterator:function(e){return new y(e)},DomPosition:w},n.DOMException=S})),N.createCoreModule("DomRange",["DomUtil"],(function(a,e){var s=a.dom,o=a.util,t=s.DomPosition,c=a.DOMException,u=s.isCharacterDataNode,l=s.getNodeIndex,d=s.isOrIsAncestorOf,r=s.getDocument,h=s.comparePoints,f=s.splitDataNode,g=s.getClosestAncestorIn,p=s.getNodeLength,i=s.arrayContains,m=s.getRootContainer,n=a.features.crashyTextNodes,v=s.removeNode;function R(e,t){return 3!=e.nodeType&&(d(e,t.startContainer)||d(e,t.endContainer))}function C(e){return e.document||r(e.startContainer)}function E(e){return new t(e.parentNode,l(e))}function N(e){return new t(e.parentNode,l(e)+1)}function y(e,t,n){var o=11==e.nodeType?e.firstChild:e;return u(t)?n==t.length?s.insertAfter(e,t):t.parentNode.insertBefore(e,0==n?t:f(t,n)):n>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[n]),o}function w(e,t,n){if(q(e),q(t),C(t)!=C(e))throw new c("WRONG_DOCUMENT_ERR");var o=h(e.startContainer,e.startOffset,t.endContainer,t.endOffset),r=h(e.endContainer,e.endOffset,t.startContainer,t.startOffset);return n?o<=0&&0<=r:o<0&&0<r}function S(e,t,n){var o,r,i,a;for(n=n||{stop:!1};i=e.next();)if(e.isPartiallySelectedSubtree()){if(!1===t(i))return void(n.stop=!0);if(S(a=e.getSubtreeIterator(),t,n),a.detach(),n.stop)return}else for(o=s.createIterator(i);r=o.next();)if(!1===t(r))return void(n.stop=!0)}function T(e){for(var t;e.next();)e.isPartiallySelectedSubtree()?(T(t=e.getSubtreeIterator()),t.detach()):e.remove()}function O(e){for(var t,n,o=C(e.range).createDocumentFragment();t=e.next();){if(e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),n=e.getSubtreeIterator(),t.appendChild(O(n)),n.detach()):e.remove(),10==t.nodeType)throw new c("HIERARCHY_REQUEST_ERR");o.appendChild(t)}return o}function _(e){return"["+(void 0===e.getName?"Range":e.getName())+"("+s.inspectNode(e.startContainer)+":"+e.startOffset+", "+s.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function A(e,t){if(this.range=e,this.clonePartiallySelectedTextNodes=t,!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var n=e.commonAncestorContainer;this.sc===this.ec&&u(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||u(this.sc)?g(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||u(this.ec)?g(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}A.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;return e&&(this._next=e!==this._last?e.nextSibling:null,u(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so))),e},remove:function(){var e,t,n=this._current;!u(n)||n!==this.sc&&n!==this.ec?n.parentNode&&v(n):(e=n===this.sc?this.so:0)!=(t=n===this.ec?this.eo:n.length)&&n.deleteData(e,t-e)},isPartiallySelectedSubtree:function(){return R(this._current,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)(e=this.range.cloneRange()).collapse(!1);else{e=new le(C(this.range));var t=this._current,n=t,o=0,r=t,i=p(t);d(t,this.sc)&&(n=this.sc,o=this.so),d(t,this.ec)&&(r=this.ec,i=this.eo),ue(e,n,o,r,i)}return new A(e,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var D=[1,3,4,5,7,8,10],b=[2,9,11],x=[1,3,4,5,7,8,10,11],P=[1,3,4,5,7,8];function I(r){return function(e,t){for(var n,o=t?e:e.parentNode;o;){if(n=o.nodeType,i(r,n))return o;o=o.parentNode}return null}}var B=I([9,11]),H=I([5,6,10,12]),L=I([6,10,12]);function M(e,t){if(L(e,t))throw new c("INVALID_NODE_TYPE_ERR")}function k(e,t){if(!i(t,e.nodeType))throw new c("INVALID_NODE_TYPE_ERR")}function W(e,t){if(t<0||t>(u(e)?e.length:e.childNodes.length))throw new c("INDEX_SIZE_ERR")}function F(e,t){if(B(e,!0)!==B(t,!0))throw new c("WRONG_DOCUMENT_ERR")}function U(e){if(H(e,!0))throw new c("NO_MODIFICATION_ALLOWED_ERR")}function j(e,t){if(!e)throw new c(t)}function z(e,t){return t<=(u(e)?e.length:e.childNodes.length)}function V(e){return!!e.startContainer&&!!e.endContainer&&!(n&&(s.isBrokenNode(e.startContainer)||s.isBrokenNode(e.endContainer)))&&m(e.startContainer)==m(e.endContainer)&&z(e.startContainer,e.startOffset)&&z(e.endContainer,e.endOffset)}function q(e){if(!V(e))throw new Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+e.inspect()+")")}var Y=document.createElement("style"),G=!1;try{Y.innerHTML="<b>x</b>",G=3==Y.firstChild.nodeType}catch(e){}var Q=(a.features.htmlParsingConforms=G)?function(e){var t=this.startContainer,n=r(t);if(!t)throw new c("INVALID_STATE_ERR");var o=null;return 1==t.nodeType?o=t:u(t)&&(o=s.parentElement(t)),(o=null===o||"HTML"==o.nodeName&&s.isHtmlNamespace(r(o).documentElement)&&s.isHtmlNamespace(o)?n.createElement("body"):o.cloneNode(!1)).innerHTML=e,s.fragmentFromNodeChildren(o)}:function(e){var t=C(this).createElement("body");return t.innerHTML=e,s.fragmentFromNodeChildren(t)};function X(e,t){q(e);var n=e.startContainer,o=e.startOffset,r=e.endContainer,i=e.endOffset,a=n===r;u(r)&&0<i&&i<r.length&&f(r,i,t),u(n)&&0<o&&o<n.length&&(n=f(n,o,t),a?(i-=o,r=n):r==n.parentNode&&i>=l(n)&&i++,o=0),e.setStartAndEnd(n,o,r,i)}function Z(e){q(e);var t=e.commonAncestorContainer.parentNode.cloneNode(!1);return t.appendChild(e.cloneContents()),t.innerHTML}var $=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],K=0,J=1,ee=2,te=3,ne=0,oe=1,re=2,ie=3;function ae(e){e.START_TO_START=K,e.START_TO_END=J,e.END_TO_END=ee,e.END_TO_START=te,e.NODE_BEFORE=ne,e.NODE_AFTER=oe,e.NODE_BEFORE_AND_AFTER=re,e.NODE_INSIDE=ie}function se(e){ae(e),ae(e.prototype)}function ce(a,s){return function(){q(this);var e,t=this.startContainer,n=this.startOffset,o=this.commonAncestorContainer,r=new A(this,!0);t!==o&&(t=(e=N(g(t,o,!0))).node,n=e.offset),S(r,U),r.reset();var i=a(r);return r.detach(),s(this,t,n,t,n),i}}function de(e,f){function t(n,o){return function(e){k(e,D),k(m(e),b);var t=(n?E:N)(e);(o?r:i)(this,t.node,t.offset)}}function r(e,t,n){var o=e.endContainer,r=e.endOffset;t===e.startContainer&&n===e.startOffset||(m(t)==m(o)&&1!=h(t,n,o,r)||(o=t,r=n),f(e,t,n,o,r))}function i(e,t,n){var o=e.startContainer,r=e.startOffset;t===e.endContainer&&n===e.endOffset||(m(t)==m(o)&&-1!=h(t,n,o,r)||(o=t,r=n),f(e,o,r,t,n))}function n(){}n.prototype=a.rangePrototype,e.prototype=new n,o.extend(e.prototype,{setStart:function(e,t){M(e,!0),W(e,t),r(this,e,t)},setEnd:function(e,t){M(e,!0),W(e,t),i(this,e,t)},setStartAndEnd:function(){var e=arguments,t=e[0],n=e[1],o=t,r=n;switch(e.length){case 3:r=e[2];break;case 4:o=e[2],r=e[3]}f(this,t,n,o,r)},setBoundary:function(e,t,n){this["set"+(n?"Start":"End")](e,t)},setStartBefore:t(!0,!0),setStartAfter:t(!1,!0),setEndBefore:t(!0,!1),setEndAfter:t(!1,!1),collapse:function(e){q(this),e?f(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):f(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){M(e,!0),f(this,e,0,e,p(e))},selectNode:function(e){M(e,!1),k(e,D);var t=E(e),n=N(e);f(this,t.node,t.offset,n.node,n.offset)},extractContents:ce(O,f),deleteContents:ce(T,f),canSurroundContents:function(){q(this),U(this.startContainer),U(this.endContainer);var e=new A(this,!0),t=e._first&&R(e._first,this)||e._last&&R(e._last,this);return e.detach(),!t},splitBoundaries:function(){X(this)},splitBoundariesPreservingPositions:function(e){X(this,e)},normalizeBoundaries:function(){q(this);function e(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(s=(a=e).length,e.appendData(t.data),v(t))}function t(e){var t=e.previousSibling;if(t&&t.nodeType==e.nodeType){var n=(r=e).length;if(i=t.length,e.insertData(0,t.data),v(t),r==a)s+=i,a=r;else if(a==e.parentNode){var o=l(e);s==o?(a=e,s=n):o<s&&s--}}}var n,r=this.startContainer,i=this.startOffset,a=this.endContainer,s=this.endOffset,o=!0;if(u(a))s==a.length?e(a):0==s&&(n=a.previousSibling)&&n.nodeType==a.nodeType&&(s=n.length,r==a&&(o=!1),n.appendData(a.data),v(a),a=n);else{if(0<s){var c=a.childNodes[s-1];c&&u(c)&&e(c)}o=!this.collapsed}if(o){if(u(r))0==i?t(r):i==r.length&&(n=r.nextSibling)&&n.nodeType==r.nodeType&&(a==n&&(s+=(a=r).length),r.appendData(n.data),v(n));else if(i<r.childNodes.length){var d=r.childNodes[i];d&&u(d)&&t(d)}}else r=a,i=s;f(this,r,i,a,s)},collapseToPoint:function(e,t){M(e,!0),W(e,t),this.setStartAndEnd(e,t)}}),se(e)}function fe(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset,e.commonAncestorContainer=e.collapsed?e.startContainer:s.getCommonAncestor(e.startContainer,e.endContainer)}function ue(e,t,n,o,r){e.startContainer=t,e.startOffset=n,e.endContainer=o,e.endOffset=r,e.document=s.getDocument(t),fe(e)}function le(e){this.startContainer=e,this.startOffset=0,this.endContainer=e,this.endOffset=0,this.document=e,fe(this)}o.extend(a.rangePrototype,{compareBoundaryPoints:function(e,t){var n,o,r,i;q(this),F(this.startContainer,t.startContainer);var a=e==te||e==K?"start":"end",s=e==J||e==K?"start":"end";return n=this[a+"Container"],o=this[a+"Offset"],r=t[s+"Container"],i=t[s+"Offset"],h(n,o,r,i)},insertNode:function(e){if(q(this),k(e,x),U(this.startContainer),d(e,this.startContainer))throw new c("HIERARCHY_REQUEST_ERR");var t=y(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){var e,t;if(q(this),this.collapsed)return C(this).createDocumentFragment();if(this.startContainer===this.endContainer&&u(this.startContainer))return(e=this.startContainer.cloneNode(!0)).data=e.data.slice(this.startOffset,this.endOffset),(t=C(this).createDocumentFragment()).appendChild(e),t;var n=new A(this,!0);return e=(function e(t){for(var n,o,r,i=C(t.range).createDocumentFragment();o=t.next();){if(n=t.isPartiallySelectedSubtree(),o=o.cloneNode(!n),n&&(r=t.getSubtreeIterator(),o.appendChild(e(r)),r.detach()),10==o.nodeType)throw new c("HIERARCHY_REQUEST_ERR");i.appendChild(o)}return i})(n),n.detach(),e},canSurroundContents:function(){q(this),U(this.startContainer),U(this.endContainer);var e=new A(this,!0),t=e._first&&R(e._first,this)||e._last&&R(e._last,this);return e.detach(),!t},surroundContents:function(e){if(k(e,P),!this.canSurroundContents())throw new c("INVALID_STATE_ERR");var t=this.extractContents();if(e.hasChildNodes())for(;e.lastChild;)e.removeChild(e.lastChild);y(e,this.startContainer,this.startOffset),e.appendChild(t),this.selectNode(e)},cloneRange:function(){q(this);for(var e,t=new le(C(this)),n=$.length;n--;)t[e=$[n]]=this[e];return t},toString:function(){q(this);var e=this.startContainer;if(e===this.endContainer&&u(e))return 3==e.nodeType||4==e.nodeType?e.data.slice(this.startOffset,this.endOffset):"";var t=[],n=new A(this,!0);return S(n,(function(e){3!=e.nodeType&&4!=e.nodeType||t.push(e.data)})),n.detach(),t.join("")},compareNode:function(e){q(this);var t=e.parentNode,n=l(e);if(!t)throw new c("NOT_FOUND_ERR");var o=this.comparePoint(t,n),r=this.comparePoint(t,n+1);return o<0?0<r?re:ne:0<r?oe:ie},comparePoint:function(e,t){return q(this),j(e,"HIERARCHY_REQUEST_ERR"),F(e,this.startContainer),h(e,t,this.startContainer,this.startOffset)<0?-1:0<h(e,t,this.endContainer,this.endOffset)?1:0},createContextualFragment:Q,toHtml:function(){return Z(this)},intersectsNode:function(e,t){if(q(this),m(e)!=m(this.startContainer))return!1;var n=e.parentNode,o=l(e);if(!n)return!0;var r=h(n,o,this.endContainer,this.endOffset),i=h(n,o+1,this.startContainer,this.startOffset);return t?r<=0&&0<=i:r<0&&0<i},isPointInRange:function(e,t){return q(this),j(e,"HIERARCHY_REQUEST_ERR"),F(e,this.startContainer),0<=h(e,t,this.startContainer,this.startOffset)&&h(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e){return w(this,e,!1)},intersectsOrTouchesRange:function(e){return w(this,e,!0)},intersection:function(e){if(this.intersectsRange(e)){var t=h(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=h(this.endContainer,this.endOffset,e.endContainer,e.endOffset),o=this.cloneRange();return-1==t&&o.setStart(e.startContainer,e.startOffset),1==n&&o.setEnd(e.endContainer,e.endOffset),o}return null},union:function(e){if(this.intersectsOrTouchesRange(e)){var t=this.cloneRange();return-1==h(e.startContainer,e.startOffset,this.startContainer,this.startOffset)&&t.setStart(e.startContainer,e.startOffset),1==h(e.endContainer,e.endOffset,this.endContainer,this.endOffset)&&t.setEnd(e.endContainer,e.endOffset),t}throw new c("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==ie},containsNodeContents:function(e){return 0<=this.comparePoint(e,0)&&this.comparePoint(e,p(e))<=0},containsRange:function(e){var t=this.intersection(e);return null!==t&&e.equals(t)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(0<n.length){t.setStart(n[0],0);var o=n.pop();return t.setEnd(o,o.length),this.containsRange(t)}return this.containsNodeContents(e)},getNodes:function(e,t){return q(this),(function(o,e,r){var i,a=!(!e||!e.length),s=!!r;a&&(i=new RegExp("^("+e.join("|")+")$"));var c=[];return S(new A(o,!1),(function(e){if((!a||i.test(e.nodeType))&&(!s||r(e))){var t=o.startContainer;if(e!=t||!u(t)||o.startOffset!=t.length){var n=o.endContainer;e==n&&u(n)&&0==o.endOffset||c.push(e)}}})),c})(this,e,t)},getDocument:function(){return C(this)},collapseBefore:function(e){this.setEndBefore(e),this.collapse(!1)},collapseAfter:function(e){this.setStartAfter(e),this.collapse(!0)},getBookmark:function(e){var t=C(this),n=a.createRange(t);e=e||s.getBody(t),n.selectNodeContents(e);var o=this.intersection(n),r=0,i=0;return o&&(n.setEnd(o.startContainer,o.startOffset),i=(r=n.toString().length)+o.toString().length),{start:r,end:i,containerNode:e}},moveToBookmark:function(e){var t=e.containerNode,n=0;this.setStart(t,0),this.collapse(!0);for(var o,r,i,a,s=[t],c=!1,d=!1;!d&&(o=s.pop());)if(3==o.nodeType)r=n+o.length,!c&&e.start>=n&&e.start<=r&&(this.setStart(o,e.start-n),c=!0),c&&e.end>=n&&e.end<=r&&(this.setEnd(o,e.end-n),d=!0),n=r;else for(i=(a=o.childNodes).length;i--;)s.push(a[i])},getName:function(){return"DomRange"},equals:function(e){return le.rangesEqual(this,e)},isValid:function(){return V(this)},inspect:function(){return _(this)},detach:function(){}}),de(le,ue),o.extend(le,{rangeProperties:$,RangeIterator:A,copyComparisonConstants:se,createPrototypeRange:de,inspect:_,toHtml:Z,getRangeDocument:C,rangesEqual:function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset}}),a.DomRange=le})),N.createCoreModule("WrappedRange",["DomRange"],(function(f,u){var l,e,y=f.dom,h=f.util,w=y.DomPosition,g=f.DomRange,p=y.getBody,m=y.getContentDocument,S=y.isCharacterDataNode;if(f.features.implementsDomRange&&(function(){var t,n,o=g.rangeProperties;function r(e){for(var t,n=o.length;n--;)e[t=o[n]]=e.nativeRange[t];e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset}l=function(e){if(!e)throw u.createError("WrappedRange: Range must be specified");this.nativeRange=e,r(this)},g.createPrototypeRange(l,(function(e,t,n,o,r){var i=e.startContainer!==t||e.startOffset!=n,a=e.endContainer!==o||e.endOffset!=r,s=!e.equals(e.nativeRange);(i||a||s)&&(e.setEnd(o,r),e.setStart(t,n))})),(t=l.prototype).selectNode=function(e){this.nativeRange.selectNode(e),r(this)},t.cloneContents=function(){return this.nativeRange.cloneContents()},t.surroundContents=function(e){this.nativeRange.surroundContents(e),r(this)},t.collapse=function(e){this.nativeRange.collapse(e),r(this)},t.cloneRange=function(){return new l(this.nativeRange.cloneRange())},t.refresh=function(){r(this)},t.toString=function(){return this.nativeRange.toString()};var e=document.createTextNode("test");p(document).appendChild(e);var i=document.createRange();i.setStart(e,0),i.setEnd(e,0);try{i.setStart(e,1),t.setStart=function(e,t){this.nativeRange.setStart(e,t),r(this)},t.setEnd=function(e,t){this.nativeRange.setEnd(e,t),r(this)},n=function(t){return function(e){this.nativeRange[t](e),r(this)}}}catch(e){t.setStart=function(t,n){try{this.nativeRange.setStart(t,n)}catch(e){this.nativeRange.setEnd(t,n),this.nativeRange.setStart(t,n)}r(this)},t.setEnd=function(t,n){try{this.nativeRange.setEnd(t,n)}catch(e){this.nativeRange.setStart(t,n),this.nativeRange.setEnd(t,n)}r(this)},n=function(n,o){return function(t){try{this.nativeRange[n](t)}catch(e){this.nativeRange[o](t),this.nativeRange[n](t)}r(this)}}}t.setStartBefore=n("setStartBefore","setEndBefore"),t.setStartAfter=n("setStartAfter","setEndAfter"),t.setEndBefore=n("setEndBefore","setStartBefore"),t.setEndAfter=n("setEndAfter","setStartAfter"),t.selectNodeContents=function(e){this.setStartAndEnd(e,0,y.getNodeLength(e))},i.selectNodeContents(e),i.setEnd(e,3);var a=document.createRange();a.selectNodeContents(e),a.setEnd(e,4),a.setStart(e,2),-1==i.compareBoundaryPoints(i.START_TO_END,a)&&1==i.compareBoundaryPoints(i.END_TO_START,a)?t.compareBoundaryPoints=function(e,t){return e==(t=t.nativeRange||t).START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END),this.nativeRange.compareBoundaryPoints(e,t)}:t.compareBoundaryPoints=function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)};var s=document.createElement("div");s.innerHTML="123";var c=s.firstChild,d=p(document);d.appendChild(s),i.setStart(c,1),i.setEnd(c,2),i.deleteContents(),"13"==c.data&&(t.deleteContents=function(){this.nativeRange.deleteContents(),r(this)},t.extractContents=function(){var e=this.nativeRange.extractContents();return r(this),e}),d.removeChild(s),d=null,h.isHostMethod(i,"createContextualFragment")&&(t.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}),p(document).removeChild(e),t.getName=function(){return"WrappedRange"},f.WrappedRange=l,f.createNativeRange=function(e){return(e=m(e,u,"createNativeRange")).createRange()}})(),f.features.implementsTextRange){function i(e,t,n,o,r){var i=e.duplicate();i.collapse(n);var a=i.parentElement();if(y.isOrIsAncestorOf(t,a)||(a=t),!a.canHaveHTML){var s=new w(a.parentNode,y.getNodeIndex(a));return{boundaryPosition:s,nodeInfo:{nodeIndex:s.offset,containerElement:s.node}}}var c=y.getDocument(a).createElement("span");c.parentNode&&y.removeNode(c);for(var d,f,u,l,h,g=n?"StartToStart":"StartToEnd",p=r&&r.containerElement==a?r.nodeIndex:0,m=a.childNodes.length,v=m,R=v;R==m?a.appendChild(c):a.insertBefore(c,a.childNodes[R]),i.moveToElementText(c),0!=(d=i.compareEndPoints(g,e))&&p!=v;){if(-1==d){if(v==p+1)break;p=R}else v=v==p+1?p:R;R=Math.floor((p+v)/2),a.removeChild(c)}if(h=c.nextSibling,-1==d&&h&&S(h)){var C;if(i.setEndPoint(n?"EndToStart":"EndToEnd",e),/[\r\n]/.test(h.data)){var E=i.duplicate(),N=E.text.replace(/\r\n/g,"\r").length;for(C=E.moveStart("character",N);-1==(d=E.compareEndPoints("StartToEnd",E));)C++,E.moveStart("character",1)}else C=i.text.length;l=new w(h,C)}else f=(o||!n)&&c.previousSibling,l=(u=(o||n)&&c.nextSibling)&&S(u)?new w(u,0):f&&S(f)?new w(f,f.data.length):new w(a,y.getNodeIndex(c));return y.removeNode(c),{boundaryPosition:l,nodeInfo:{nodeIndex:R,containerElement:a}}}function r(e,t){var n,o,r,i,a=e.offset,s=y.getDocument(e.node),c=p(s).createTextRange(),d=S(e.node);return o=d?(n=e.node).parentNode:(n=a<(i=e.node.childNodes).length?i[a]:null,e.node),(r=s.createElement("span")).innerHTML="&#feff;",n?o.insertBefore(r,n):o.appendChild(r),c.moveToElementText(r),c.collapse(!t),o.removeChild(r),d&&c[t?"moveStart":"moveEnd"]("character",a),c}((e=function(e){this.textRange=e,this.refresh()}).prototype=new g(document)).refresh=function(){var e,t,n,o,r=(function(e){var t=e.parentElement(),n=e.duplicate();n.collapse(!0);var o=n.parentElement();(n=e.duplicate()).collapse(!1);var r=n.parentElement(),i=o==r?o:y.getCommonAncestor(o,r);return i==t?i:y.getCommonAncestor(t,i)})(this.textRange);t=0==(o=this.textRange).compareEndPoints("StartToEnd",o)?e=i(this.textRange,r,!0,!0).boundaryPosition:(e=(n=i(this.textRange,r,!0,!1)).boundaryPosition,i(this.textRange,r,!1,!1,n.nodeInfo).boundaryPosition),this.setStart(e.node,e.offset),this.setEnd(t.node,t.offset)},e.prototype.getName=function(){return"WrappedTextRange"},g.copyComparisonConstants(e);function t(e){if(e.collapsed)return r(new w(e.startContainer,e.startOffset),!0);var t=r(new w(e.startContainer,e.startOffset),!0),n=r(new w(e.endContainer,e.endOffset),!1),o=p(g.getRangeDocument(e)).createTextRange();return o.setEndPoint("StartToStart",t),o.setEndPoint("EndToEnd",n),o}if(e.rangeToTextRange=t,e.prototype.toTextRange=function(){return t(this)},f.WrappedTextRange=e,!f.features.implementsDomRange||f.config.preferTextRange){var n=Function("return this;")();void 0===n.Range&&(n.Range=e),f.createNativeRange=function(e){return e=m(e,u,"createNativeRange"),p(e).createTextRange()},f.WrappedRange=e}}f.createRange=function(e){return e=m(e,u,"createRange"),new f.WrappedRange(f.createNativeRange(e))},f.createRangyRange=function(e){return e=m(e,u,"createRangyRange"),new g(e)},h.createAliasForDeprecatedMethod(f,"createIframeRange","createRange"),h.createAliasForDeprecatedMethod(f,"createIframeRangyRange","createRangyRange"),f.addShimListener((function(e){var t=e.document;void 0===t.createRange&&(t.createRange=function(){return f.createRange(t)}),t=e=null}))})),N.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],(function(u,c){u.config.checkSelectionRanges=!0;var r,i,e="boolean",t="number",l=u.dom,n=u.util,o=n.isHostMethod,s=u.DomRange,a=u.WrappedRange,d=u.DOMException,f=l.DomPosition,h=u.features,g="Control",p=l.getDocument,m=l.getBody,v=s.rangesEqual;function R(e){return"string"==typeof e?/^backward(s)?$/i.test(e):!!e}function C(e,t){if(e){if(l.isWindow(e))return e;if(e instanceof q)return e.win;var n=l.getContentDocument(e,c,t);return l.getWindow(n)}return window}function E(e){return C(e,"getDocSelection").document.selection}function N(e){var t=!1;return e.anchorNode&&(t=1==l.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)),t}var y=o(window,"getSelection"),w=n.isHostObject(document,"selection");h.implementsWinGetSelection=y;var S=(h.implementsDocSelection=w)&&(!y||u.config.preferTextRange);if(S)r=E,u.isSelectionValid=function(e){var t=C(e,"isSelectionValid").document,n=t.selection;return"None"!=n.type||p(n.createRange().parentElement())==t};else{if(!y)return c.fail("Neither document.selection or window.getSelection() detected."),!1;r=function(e){return C(e,"getWinSelection").getSelection()},u.isSelectionValid=function(){return!0}}var T=(u.getNativeSelection=r)();if(!T)return c.fail("Native selection was null (possibly issue 138?)"),!1;var O=u.createNativeRange(document),_=m(document),A=n.areHostProperties(T,["anchorNode","focusNode","anchorOffset","focusOffset"]);h.selectionHasAnchorAndFocus=A;var D=o(T,"extend");h.selectionHasExtend=D;var b=typeof T.rangeCount==t;h.selectionHasRangeCount=b;var x=!1,P=!0,I=D?function(e,t){var n=s.getRangeDocument(t),o=u.createRange(n);o.collapseToPoint(t.endContainer,t.endOffset),e.addRange(W(o)),e.extend(t.startContainer,t.startOffset)}:null;n.areHostMethods(T,["addRange","getRangeAt","removeAllRanges"])&&typeof T.rangeCount==t&&h.implementsDomRange&&(function(){var e=window.getSelection();if(e){for(var t=e.rangeCount,n=1<t,o=[],r=N(e),i=0;i<t;++i)o[i]=e.getRangeAt(i);var a=l.createTestElement(document,"",!1),s=a.appendChild(document.createTextNode("   ")),c=document.createRange();if(c.setStart(s,1),c.collapse(!0),e.removeAllRanges(),e.addRange(c),P=1==e.rangeCount,e.removeAllRanges(),!n){var d=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(d&&36<=parseInt(d[1]))x=!1;else{var f=c.cloneRange();c.setStart(s,0),f.setEnd(s,3),f.setStart(s,2),e.addRange(c),e.addRange(f),x=2==e.rangeCount}}for(l.removeNode(a),e.removeAllRanges(),i=0;i<t;++i)0==i&&r?I?I(e,o[i]):(u.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),e.addRange(o[i])):e.addRange(o[i])}})(),h.selectionSupportsMultipleRanges=x,h.collapsedNonEditableSelectionsSupported=P;var B,H,L=!1;function M(e,t,n){var o=n?"end":"start",r=n?"start":"end";e.anchorNode=t[o+"Container"],e.anchorOffset=t[o+"Offset"],e.focusNode=t[r+"Container"],e.focusOffset=t[r+"Offset"]}function k(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0}function W(e){var t;return e instanceof s?((t=u.createNativeRange(e.getDocument())).setEnd(e.endContainer,e.endOffset),t.setStart(e.startContainer,e.startOffset)):e instanceof a?t=e.nativeRange:h.implementsDomRange&&e instanceof l.getWindow(e.startContainer).Range&&(t=e),t}function F(e){var t=e.getNodes();if(!(function(e){if(e.length&&1==e[0].nodeType){for(var t=1,n=e.length;t<n;++t)if(!l.isAncestorOf(e[0],e[t]))return;return 1}})(t))throw c.createError("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return t[0]}function U(e){return e&&void 0!==e.text}function j(e,t){var n=new a(t);e._ranges=[n],M(e,n,!1),e.rangeCount=1,e.isCollapsed=n.collapsed}function z(e){if(e._ranges.length=0,"None"==e.docSelection.type)k(e);else{var t=e.docSelection.createRange();if(U(t))j(e,t);else{e.rangeCount=t.length;for(var n,o=p(t.item(0)),r=0;r<e.rangeCount;++r)(n=u.createRange(o)).selectNode(t.item(r)),e._ranges.push(n);e.isCollapsed=1==e.rangeCount&&e._ranges[0].collapsed,M(e,e._ranges[e.rangeCount-1],!1)}}}function V(e,t){for(var n=e.docSelection.createRange(),o=F(t),r=p(n.item(0)),i=m(r).createControlRange(),a=0,s=n.length;a<s;++a)i.add(n.item(a));try{i.add(o)}catch(e){throw c.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}i.select(),z(e)}function q(e,t,n){this.nativeSelection=e,this.docSelection=t,this._ranges=[],this.win=n,this.refresh()}function Y(e){e.win=e.anchorNode=e.focusNode=e._ranges=null,e.rangeCount=e.anchorOffset=e.focusOffset=0,e.detached=!0}_&&o(_,"createControlRange")&&(B=_.createControlRange(),n.areHostProperties(B,["item","add"])&&(L=!0)),h.implementsControlRange=L,i=A?function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:function(e){return!!e.rangeCount&&e.getRangeAt(e.rangeCount-1).collapsed},o(T,"getRangeAt")?H=function(e,t){try{return e.getRangeAt(t)}catch(e){return null}}:A&&(H=function(e){var t=p(e.anchorNode),n=u.createRange(t);return n.setStartAndEnd(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset),n.collapsed!==this.isCollapsed&&n.setStartAndEnd(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset),n}),q.prototype=u.selectionPrototype;var G=[];function Q(e,t){for(var n,o,r=G.length;r--;)if(o=(n=G[r]).selection,"deleteAll"==t)Y(o);else if(n.win==e)return"delete"==t?(G.splice(r,1),!0):o;return"deleteAll"==t&&(G.length=0),null}function X(e){if(e&&e instanceof q)return e.refresh(),e;var t=Q(e=C(e,"getNativeSelection")),n=r(e),o=w?E(e):null;return t?(t.nativeSelection=n,t.docSelection=o,t.refresh()):(t=new q(n,o,e),G.push({win:e,selection:t})),t}u.getSelection=X,n.createAliasForDeprecatedMethod(u,"getIframeSelection","getSelection");var Z,$=q.prototype;function K(e,t){for(var n,o=p(t[0].startContainer),r=m(o).createControlRange(),i=0,a=t.length;i<a;++i){n=F(t[i]);try{r.add(n)}catch(e){throw c.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}r.select(),z(e)}if(!S&&A&&n.areHostMethods(T,["removeAllRanges","addRange"])){$.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),k(this)};function J(e,t){I(e.nativeSelection,t),e.refresh()}$.addRange=b?function(e,t){if(L&&w&&this.docSelection.type==g)V(this,e);else if(R(t)&&D)J(this,e);else{var n;n=x?this.rangeCount:(this.removeAllRanges(),0);var o=W(e).cloneRange();try{this.nativeSelection.addRange(o)}catch(e){}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==n+1){if(u.config.checkSelectionRanges){var r=H(this.nativeSelection,this.rangeCount-1);r&&!v(r,e)&&(e=new a(r))}this._ranges[this.rangeCount-1]=e,M(this,e,te(this.nativeSelection)),this.isCollapsed=i(this)}else this.refresh()}}:function(e,t){R(t)&&D?J(this,e):(this.nativeSelection.addRange(W(e)),this.refresh())},$.setRanges=function(e){if(L&&w&&1<e.length)K(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;t<n;++t)this.addRange(e[t])}}}else{if(!(o(T,"empty")&&o(O,"select")&&L&&S))return c.fail("No means of selecting a Range or TextRange was found"),!1;$.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var e;if(this.anchorNode)e=p(this.anchorNode);else if(this.docSelection.type==g){var t=this.docSelection.createRange();t.length&&(e=p(t.item(0)))}if(e)m(e).createTextRange().select(),this.docSelection.empty()}}catch(e){}k(this)},$.addRange=function(e){this.docSelection.type==g?V(this,e):(u.WrappedTextRange.rangeToTextRange(e).select(),this._ranges[0]=e,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,M(this,e,!1))},$.setRanges=function(e){this.removeAllRanges();var t=e.length;1<t?K(this,e):t&&this.addRange(e[0])}}if($.getRangeAt=function(e){if(e<0||e>=this.rangeCount)throw new d("INDEX_SIZE_ERR");return this._ranges[e].cloneRange()},S)Z=function(e){var t;u.isSelectionValid(e.win)?t=e.docSelection.createRange():(t=m(e.win.document).createTextRange()).collapse(!0),e.docSelection.type==g?z(e):U(t)?j(e,t):k(e)};else if(o(T,"getRangeAt")&&typeof T.rangeCount==t)Z=function(e){if(L&&w&&e.docSelection.type==g)z(e);else if(e._ranges.length=e.rangeCount=e.nativeSelection.rangeCount,e.rangeCount){for(var t=0,n=e.rangeCount;t<n;++t)e._ranges[t]=new u.WrappedRange(e.nativeSelection.getRangeAt(t));M(e,e._ranges[e.rangeCount-1],te(e.nativeSelection)),e.isCollapsed=i(e)}else k(e)};else{if(!A||typeof T.isCollapsed!=e||typeof O.collapsed!=e||!h.implementsDomRange)return c.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;Z=function(e){var t,n,o,r=e.nativeSelection;r.anchorNode?(t=H(r,0),e._ranges=[t],e.rangeCount=1,o=(n=e).nativeSelection,n.anchorNode=o.anchorNode,n.anchorOffset=o.anchorOffset,n.focusNode=o.focusNode,n.focusOffset=o.focusOffset,e.isCollapsed=i(e)):k(e)}}$.refresh=function(e){var t=e?this._ranges.slice(0):null,n=this.anchorNode,o=this.anchorOffset;if(Z(this),e){var r=t.length;if(r!=this._ranges.length)return!0;if(this.anchorNode!=n||this.anchorOffset!=o)return!0;for(;r--;)if(!v(t[r],this._ranges[r]))return!0;return!1}};function ee(e,t){var n=e.getAllRanges();e.removeAllRanges();for(var o=0,r=n.length;o<r;++o)v(t,n[o])||e.addRange(n[o]);e.rangeCount||k(e)}var te;function ne(e,t){if(e.win.document!=p(t))throw new d("WRONG_DOCUMENT_ERR")}function oe(o){return function(e,t){var n;this.rangeCount?(n=this.getRangeAt(0))["set"+(o?"Start":"End")](e,t):(n=u.createRange(this.win.document)).setStartAndEnd(e,t),this.setSingleRange(n,this.isBackward())}}function re(e){var t=[],n=new f(e.anchorNode,e.anchorOffset),o=new f(e.focusNode,e.focusOffset),r="function"==typeof e.getName?e.getName():"Selection";if(void 0!==e.rangeCount)for(var i=0,a=e.rangeCount;i<a;++i)t[i]=s.inspect(e.getRangeAt(i));return"["+r+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+o.inspect()+"]"}$.removeRange=L&&w?function(e){if(this.docSelection.type==g){for(var t=this.docSelection.createRange(),n=F(e),o=p(t.item(0)),r=m(o).createControlRange(),i=!1,a=0,s=t.length;a<s;++a)t.item(a)!==n||i?r.add(t.item(a)):i=!0;r.select(),z(this)}else ee(this,e)}:function(e){ee(this,e)},!S&&A&&h.implementsDomRange?(te=N,$.isBackward=function(){return te(this)}):te=$.isBackward=function(){return!1},$.isBackwards=$.isBackward,$.toString=function(){for(var e=[],t=0,n=this.rangeCount;t<n;++t)e[t]=""+this._ranges[t];return e.join("")},$.collapse=function(e,t){ne(this,e);var n=u.createRange(e);n.collapseToPoint(e,t),this.setSingleRange(n),this.isCollapsed=!0},$.collapseToStart=function(){if(!this.rangeCount)throw new d("INVALID_STATE_ERR");var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)},$.collapseToEnd=function(){if(!this.rangeCount)throw new d("INVALID_STATE_ERR");var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)},$.selectAllChildren=function(e){ne(this,e);var t=u.createRange(e);t.selectNodeContents(e),this.setSingleRange(t)},$.deleteFromDocument=function(){if(L&&w&&this.docSelection.type==g){for(var e,t=this.docSelection.createRange();t.length;)e=t.item(0),t.remove(e),l.removeNode(e);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var o=0,r=n.length;o<r;++o)n[o].deleteContents();this.addRange(n[r-1])}}},$.eachRange=function(e,t){for(var n=0,o=this._ranges.length;n<o;++n)if(e(this.getRangeAt(n)))return t},$.getAllRanges=function(){var t=[];return this.eachRange((function(e){t.push(e)})),t},$.setSingleRange=function(e,t){this.removeAllRanges(),this.addRange(e,t)},$.callMethodOnEachRange=function(t,n){var o=[];return this.eachRange((function(e){o.push(e[t].apply(e,n||[]))})),o},$.setStart=oe(!0),$.setEnd=oe(!1),u.rangePrototype.select=function(e){X(this.getDocument()).setSingleRange(this,e)},$.changeEachRange=function(t){var n=[],e=this.isBackward();this.eachRange((function(e){t(e),n.push(e)})),this.removeAllRanges(),e&&1==n.length?this.addRange(n[0],"backward"):this.setRanges(n)},$.containsNode=function(t,n){return this.eachRange((function(e){return e.containsNode(t,n)}),!0)||!1},$.getBookmark=function(e){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[e])}},$.moveToBookmark=function(e){for(var t,n,o=[],r=0;t=e.rangeBookmarks[r++];)(n=u.createRange(this.win)).moveToBookmark(t),o.push(n);e.backward?this.setSingleRange(o[0],"backward"):this.setRanges(o)},$.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}},$.restoreRanges=function(e){this.removeAllRanges();for(var t,n=0;t=e.ranges[n];++n)this.addRange(t,e.backward&&0==n)},$.toHtml=function(){var t=[];return this.eachRange((function(e){t.push(s.toHtml(e))})),t.join("")},h.implementsTextRange&&($.getNativeTextRange=function(){var e;if(e=this.docSelection){var t=e.createRange();if(U(t))return t;throw c.createError("getNativeTextRange: selection is a control selection")}if(0<this.rangeCount)return u.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw c.createError("getNativeTextRange: selection contains no range")}),$.getName=function(){return"WrappedSelection"},$.inspect=function(){return re(this)},$.detach=function(){Q(this.win,"delete"),Y(this)},q.detachAll=function(){Q(null,"deleteAll")},q.inspect=re,q.isDirectionBackward=R,u.Selection=q,u.selectionPrototype=$,u.addShimListener((function(e){void 0===e.getSelection&&(e.getSelection=function(){return X(e)}),e=null}))}));function B(e){H||(H=!0,!N.initialized&&N.config.autoInitialize&&_())}var H=!1;return C&&("complete"==document.readyState?B():(f(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",B,!1),v(window,"load",B))),N}),this);